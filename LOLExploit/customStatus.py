from lcu_driver import Connector
import colorama
import os
import time
from datetime import datetime
import ctypes

client = Connector()
colorama.init()
ctypes.windll.kernel32.SetConsoleTitleW("[LF] Time - Status Message")

print(colorama.Style.BRIGHT + colorama.Fore.YELLOW + "[LF] Time - Status Message" + colorama.Style.RESET_ALL) 

@client.ready
async def main(cmd) -> None:
    summoner = await cmd.request("GET", "/lol-summoner/v1/current-summoner")
    if summoner.status == 200:
        data: dict = await summoner.json()
        print(colorama.Style.BRIGHT + colorama.Fore.CYAN + "[LF] League of Legends Client has been founded." + colorama.Style.RESET_ALL) 
        print(colorama.Style.BRIGHT + colorama.Fore.MAGENTA + "[LF] Logined Account : " + colorama.Fore.GREEN + data["displayName"] + colorama.Style.RESET_ALL)
        while True:
            now = datetime.now()
            date_time = now.strftime("%H:%M")
            await ChangeStatus(cmd, date_time)
            time.sleep(3)

async def ChangeStatus(cmd, new_status) -> bool:
    lolChat = await cmd.request("PUT", "/lol-chat/v1/me", data = {"statusMessage": new_status})
    if lolChat.status == 200:
        return True
    else:
        return False

@client.close
async def clientClosed(cmd) -> None:
    print(colorama.Style.BRIGHT + colorama.Fore.RED + "[LF] Client communication closed." + colorama.Style.RESET_ALL)

client.start()